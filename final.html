<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FutureYou - AI Career Mentor</title>
    <style>
        /* Basic CSS for a beginner-level project */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #1a1a2e;
            color: #e0e0e0;
            line-height: 1.5;
        }

        .container {
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
        }

        /* All sections are hidden by default */
        .page-section {
            display: none;
        }
        
        /* The active class makes a section visible */
        .page-section.active {
            display: block;
        }
        
        /* Card styling for content */
        .card {
            background-color: #2a2a4e;
            padding: 30px;
            border-radius: 8px;
            border: 1px solid #4a4a70;
            margin-bottom: 20px;
        }

        h1, h2, h3 {
            margin-bottom: 1rem;
            color: #a78bfa;
        }

        p {
            margin-bottom: 1rem;
            color: #c0c0e0;
        }

        /* Button styles */
        .btn {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1em;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .btn:hover:not(:disabled) {
            background-color: #0056b3;
        }

        .btn:disabled {
            background-color: #555;
            cursor: not-allowed;
        }

        .btn-secondary {
            background-color: #6c757d;
        }
        
        .btn-secondary:hover {
            background-color: #5a6268;
        }
        
        .btn-container {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        /* File Upload Area */
        .upload-zone {
            border: 2px dashed #4a4a70;
            border-radius: 5px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
        }
        
        .upload-zone:hover {
            background-color: #3a3a5e;
            border-color: #a78bfa;
        }

        .file-input {
            display: none;
        }
        
        /* Form inputs */
        textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #4a4a70;
            border-radius: 5px;
            background-color: #1a1a2e;
            color: #e0e0e0;
            font-size: 1em;
            min-height: 80px;
        }

        /* MCQ styles */
        .mcq-question {
            margin-bottom: 20px;
            background-color: #1a1a2e;
            padding: 15px;
            border-radius: 5px;
        }
        .mcq-option {
            margin: 5px 0;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        .mcq-option:hover {
            background-color: #3a3a5e;
        }
        .mcq-option input {
            margin-right: 10px;
        }
        
        /* Loader */
        .loader {
            text-align: center;
            padding: 50px;
        }

        /* Results */
        .results-card {
             background-color: #2a2a4e;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #4a4a70;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <section id="heroSection" class="page-section active">
            <div class="card" style="text-align: center;">
                <h1>FutureYou</h1>
                <p>Your AI-Powered Career Mentor</p>
                <button class="btn" onclick="showStep(1)">Start Your Journey</button>
            </div>
        </section>

        <section id="step1" class="page-section">
            <div class="card">
                <h2>Step 1: Upload Your Resume</h2>
                <p>Let's analyze your skills and experience.</p>
                <div class="upload-zone" id="uploadZone">
                    <p>Drag & Drop your resume here, or click to select.</p>
                    <p style="font-size: 0.8em;">(PDF or DOCX files only)</p>
                    <input type="file" id="fileInput" class="file-input" accept=".pdf,.docx">
                </div>
                <p id="fileName" style="margin-top: 15px;"></p>
                <div class="btn-container">
                    <button class="btn btn-secondary" onclick="showStep(0)">Back</button>
                    <button class="btn" id="step1Next" onclick="showStep(2)" disabled>Next</button>
                </div>
            </div>
        </section>

        <section id="step2" class="page-section">
            <div class="card">
                <h2>Step 2: Tell Us About Yourself</h2>
                <p>Help us understand what you're passionate about.</p>
                <div class="interest-questions">
                    <label>What subjects or topics do you enjoy?</label>
                    <textarea id="interest1"></textarea>
                    <label>What are your hobbies?</label>
                    <textarea id="interest2"></textarea>
                    <label>What kind of problems do you want to solve?</label>
                    <textarea id="interest3"></textarea>
                </div>
                <div class="btn-container">
                    <button class="btn btn-secondary" onclick="showStep(1)">Back</button>
                    <button class="btn" onclick="showStep(3)">Next</button>
                </div>
            </div>
        </section>

        <section id="step3" class="page-section">
            <div class="card">
                <h2>Step 3: Personality Assessment</h2>
                <p>Answer a few questions about your work style.</p>
                <div id="mcqContainer"></div>
                <div class="btn-container">
                    <button class="btn btn-secondary" onclick="showStep(2)">Back</button>
                    <button class="btn" onclick="analyzeCareer()">Analyze My Career</button>
                </div>
            </div>
        </section>

        <section id="loadingSection" class="page-section">
            <div class="card loader">
                <h2>Analyzing Your Future...</h2>
                <p>Please wait, this may take up to 20 seconds.</p>
            </div>
        </section>

        <section id="resultsSection" class="page-section">
            <div id="resultsContainer">
                </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" onclick="location.reload()">Start New Analysis</button>
            </div>
        </section>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>

    <script>
        // --- API KEY CONFIGURATION ---
        const GEMINI_API_KEY = 'YOUR_API_KEY_HERE';

        // --- GLOBAL VARIABLES ---
        let resumeText = '';
        const mcqQuestions = [
            { id: 1, question: "How do you prefer to work on projects?", options: ["Alone", "In a team", "Mix of both"] },
            { id: 2, question: "Which describes you better?", options: ["Creative", "Analytical", "Practical"] },
            { id: 3, question: "Which work environment appeals to you most?", options: ["Fast-paced startup", "Stable corporate company", "Remote/freelance"] },
            { id: 4, question: "What motivates you most in a career?", options: ["High salary", "Making an impact", "Learning and growth"] },
            { id: 5, question: "Do you enjoy learning new technologies/skills?", options: ["Yes, constantly", "Only when required", "I prefer mastering what I know"] }
        ];

        // --- DOM ELEMENT SELECTION ---
        const sections = document.querySelectorAll('.page-section');
        const uploadZone = document.getElementById('uploadZone');
        const fileInput = document.getElementById('fileInput');
        const fileNameEl = document.getElementById('fileName');
        const step1NextBtn = document.getElementById('step1Next');
        const mcqContainer = document.getElementById('mcqContainer');
        const resultsContainer = document.getElementById('resultsContainer');

        // --- NAVIGATION ---
        // Function to show the correct section of the page
        function showStep(stepIndex) {
            sections.forEach((section, index) => {
                section.classList.toggle('active', index === stepIndex);
            });
        }
        
        // --- MCQ QUESTION RENDERING ---
        // Function to create the HTML for the personality quiz
        function renderMCQs() {
            mcqQuestions.forEach(q => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'mcq-question';
                let optionsHTML = '';
                q.options.forEach(option => {
                    optionsHTML += `
                        <label class="mcq-option">
                            <input type="radio" name="q${q.id}" value="${option}"> ${option}
                        </label>`;
                });
                questionDiv.innerHTML = `<h4>${q.question}</h4>${optionsHTML}`;
                mcqContainer.appendChild(questionDiv);
            });
        }

        // --- FILE UPLOAD HANDLING ---
        pdfjsLib.GlobalWorkerOptions.workerSrc = `https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js`;
        uploadZone.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', () => handleFile(fileInput.files[0]));
        uploadZone.addEventListener('dragover', (e) => e.preventDefault());
        uploadZone.addEventListener('drop', (e) => {
            e.preventDefault();
            handleFile(e.dataTransfer.files[0]);
        });

        // Function to read the uploaded file and extract its text
        function handleFile(file) {
            if (!file) return;
            fileNameEl.textContent = `Uploading: ${file.name}`;
            step1NextBtn.disabled = true;

            const reader = new FileReader();
            reader.onload = async function(event) {
                try {
                    const arrayBuffer = event.target.result;
                    if (file.type === "application/pdf") {
                        const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
                        let text = '';
                        for (let i = 1; i <= pdf.numPages; i++) {
                            const page = await pdf.getPage(i);
                            const content = await page.getTextContent();
                            text += content.items.map(item => item.str).join(' ');
                        }
                        resumeText = text;
                    } else { // Assumes DOCX
                        const result = await mammoth.extractRawText({ arrayBuffer });
                        resumeText = result.value;
                    }
                    fileNameEl.textContent = `âœ“ Uploaded: ${file.name}`;
                    step1NextBtn.disabled = false;
                } catch (error) {
                    fileNameEl.textContent = `Error reading file. Please try another.`;
                    console.error("Error extracting text:", error);
                }
            };
            reader.readAsArrayBuffer(file);
        }

        // --- MAIN AI ANALYSIS FUNCTION ---
        // This function gathers all data and sends it to the AI
        async function analyzeCareer() {
            showStep(4); // Show loading screen

            // Gather all the user's answers
            const interests = {
                q1: document.getElementById('interest1').value,
                q2: document.getElementById('interest2').value,
                q3: document.getElementById('interest3').value
            };
            
            let mcqAnswers = {};
            mcqQuestions.forEach(q => {
                const selected = document.querySelector(`input[name="q${q.id}"]:checked`);
                mcqAnswers[q.question] = selected ? selected.value : "Not answered";
            });

            // The 'prompt' is the big message we send to the AI
            const prompt = `
                Analyze the following student profile and recommend a career path.
                
                Resume Text: ${resumeText}
                Interests: 
                 - Topics: ${interests.q1}
                 - Hobbies: ${interests.q2}
                 - Problems to solve: ${interests.q3}
                Personality Answers: ${JSON.stringify(mcqAnswers)}

                Respond ONLY with a valid JSON object with this structure:
                {
                  "personality_title": "A short personality title",
                  "personality_summary": "A 2-sentence summary of their personality.",
                  "career_matches": [
                    {"role": "Job Role 1", "reason": "Why this is a good fit."},
                    {"role": "Job Role 2", "reason": "Why this is a good fit."}
                  ],
                  "learning_roadmap": [
                    {"step": "Step 1: Foundation", "details": "Learn these basic skills..."},
                    {"step": "Step 2: Intermediate", "details": "Next, learn these skills..."},
                    {"step": "Step 3: Advanced", "details": "Finally, learn these skills..."}
                  ]
                }
            `;

            // This sends the request to the Google Gemini API
            try {
                // IMPORTANT: This is the corrected URL for the AI model
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });

                if (!response.ok) {
                    throw new Error(`The AI server responded with an error.`);
                }

                const data = await response.json();
                const jsonString = data.candidates[0].content.parts[0].text;
                const parsedData = JSON.parse(jsonString);
                
                displayResults(parsedData);

            } catch (error) {
                console.error("Critical Error:", error);
                displayError(error.message);
            }
        }
        
        // --- DISPLAY RESULTS ---
        // This function takes the AI's response and creates the HTML to show it
        function displayResults(data) {
            let careerMatchesHTML = '';
            data.career_matches.forEach(match => {
                careerMatchesHTML += `
                    <div class="results-card">
                        <h3>${match.role}</h3>
                        <p>${match.reason}</p>
                    </div>
                `;
            });

            let roadmapHTML = '';
            data.learning_roadmap.forEach(item => {
                roadmapHTML += `
                     <div class="results-card">
                        <h3>${item.step}</h3>
                        <p>${item.details}</p>
                    </div>
                `;
            });
            
            resultsContainer.innerHTML = `
                <div class="results-card">
                    <h2>Your Profile</h2>
                    <h3>${data.personality_title}</h3>
                    <p>${data.personality_summary}</p>
                </div>
                <h2>Top Career Matches</h2>
                ${careerMatchesHTML}
                <h2>Your Learning Roadmap</h2>
                ${roadmapHTML}
            `;
            showStep(5); // Show results section
        }

        // Function to show an error message if something goes wrong
        function displayError(errorMessage) {
            resultsContainer.innerHTML = `
                <div class="card">
                     <h2>An Error Occurred</h2>
                     <p>We couldn't get a response from the AI. This is usually a network issue or a problem with the API Key.</p>
                     <p><strong>Error Details:</strong> ${errorMessage}</p>
                </div>
            `;
            showStep(5);
        }

        // --- INITIALIZATION ---
        // Code that runs when the page first loads
        document.addEventListener('DOMContentLoaded', () => {
            renderMCQs();
            showStep(0); // Show the first section
        });
    </script>
</body>
</html>